from pathlib import Path

def get_filename_for_type(filepath, file_type):
    path = Path(filepath)
    stem = path.stem
    
    if '_' not in stem:
        raise ValueError(f"No underscore found in filename: {stem}")
    
    base_name = stem.rsplit('_', 1)[0]
    new_stem = f"{base_name}_{file_type}"
    new_path = path.with_stem(new_stem)
    
    return str(new_path)