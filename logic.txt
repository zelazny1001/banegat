from pathlib import Path

def get_filename_for_type(filepath, file_type):
    path = Path(filepath)
    stem = path.stem
    suffix = path.suffix
    
    if '_' not in stem:
        raise ValueError(f"No underscore found in filename: {stem}")
    
    base_name = stem.rsplit('_', 1)[0]
    new_filename = f"{base_name}_{file_type}{suffix}"
    new_path = path.parent / new_filename
    
    return str(new_path)